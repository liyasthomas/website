<link rel="import" href="../bower_components/polymer/polymer-element.html">
<link rel="import" href="../bower_components/app-route/app-location.html">
<link rel="import" href="../bower_components/app-route/app-route.html">
<link rel="import" href="../bower_components/app-layout/app-drawer/app-drawer.html">
<link rel="import" href="../bower_components/app-layout/app-drawer-layout/app-drawer-layout.html">
<link rel="import" href="../bower_components/app-layout/app-header/app-header.html">
<link rel="import" href="../bower_components/app-layout/app-header-layout/app-header-layout.html">
<link rel="import" href="../bower_components/app-layout/app-scroll-effects/app-scroll-effects.html">
<link rel="import" href="../bower_components/app-layout/app-toolbar/app-toolbar.html">
<link rel="import" href="../bower_components/iron-media-query/iron-media-query.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/iron-collapse/iron-collapse.html">
<link rel="import" href="../bower_components/iron-selector/iron-selector.html">
<link rel="import" href="../bower_components/iron-image/iron-image.html">
<link rel="import" href="../bower_components/paper-toast/paper-toast.html">
<link rel="import" href="../bower_components/paper-listbox/paper-listbox.html">
<link rel="import" href="../bower_components/paper-item/paper-icon-item.html">
<link rel="import" href="../bower_components/paper-tabs/paper-tabs.html">
<link rel="import" href="../bower_components/paper-progress/paper-progress.html">
<link rel="import" href="../bower_components/paper-button/paper-button.html">
<link rel="import" href="../bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner-lite.html">
<link rel="import" href="../bower_components/paper-fab/paper-fab.html">
<link rel="import" href="../bower_components/neon-animation/web-animations.html">
<link rel="import" href="../bower_components/neon-animation/neon-animated-pages.html">
<link rel="import" href="../bower_components/neon-animation/neon-animatable.html">
<link rel="import" href="../bower_components/neon-animation/neon-animations.html">
<link rel="import" href="my-icons.html">
<link rel="import" href="shared-styles.html">
<link rel="lazy-import" href="my-home.html">
<link rel="lazy-import" href="my-projects.html">
<link rel="lazy-import" href="my-about.html">
<link rel="lazy-import" href="my-android.html">
<link rel="lazy-import" href="my-web.html">
<link rel="lazy-import" href="my-other.html">
<link rel="lazy-import" href="my-saap.html">
<link rel="lazy-import" href="my-404.html">
<dom-module id="my-app">
	<template>
    <style is="custom-style" include="shared-styles">
      :host {
        display: block;
				--primary-color: #fff;
				--light-primary-color: #fff;
				--dark-primary-color: #fff;
				--accent-color: #0235ff;;
				--light-accent-color: #0037ff;
				--dark-accent-color: #0000ff;
				--primary-text-color: rgba(0,0,0,.87);
				--secondary-text-color: rgba(0,0,0,.38);
				--light-text-color: rgba(0,0,0,.12);
				--paper-tabs-selection-bar-color: var(--accent-color);
				--paper-tab-ink: var(--light-text-color);
				--paper-fab-keyboard-focus-background: var(--accent-color);
				--paper-progress-active-color: var(--light-accent-color);
				--paper-progress-secondary-color: var(--dark-accent-color);
				--paper-progress-container-color: var(--accent-color);
				color: var(--primary-text-color);
/*
        --iron-icon-height: 26px;
        --iron-icon-width: 26px;
*/
      }
      :host([page=home]) .ptheme {
        background-color: #ffdf00;
				color: #ff0266;
      }
      :host([page=home]) .stheme {
        background-color: #0235ff;
				color: #fff;
      }
      :host([page=projects]) .ptheme {
        background-color: #0235ff;
				color: #ff0266;
      }
      :host([page=projects]) .stheme {
        background-color: #ffdf00;
				color: #fff;
      }
      :host([page=about]) .ptheme {
        background-color: #1e1e2e;
				color: #ffdf00;
      }
      :host([page=about]) .stheme {
        background-color: #ff0266;
				color: #fff;
      }
			[hidden] {
				display: none;
			}
			a {
        text-decoration: none;
				outline: none;
				color: inherit;
			}
			app-drawer {
				--app-drawer-scrim-background: rgba(0, 0, 0, 0.4);
				--app-drawer-content-container: {
      		@apply --shadow-elevation-12dp;
					background-color: #fff;
				}
			}
      .drawer-contents {
				height: 100%;
				overflow: auto;
      }
			span.expand {
				width: calc(100% - 80px);
			}
			.category {
				background-color: var(--paper-grey-100);
				color: var(--paper-grey-500);
				border-top: 1px solid var(--paper-grey-200);
				border-bottom: 1px solid var(--paper-grey-200);
			}
			#home.iron-selected {
				color: #0235ff;
			}
			#projects.iron-selected {
				color: #ffdf00;
			}
			#about.iron-selected {
				color: #ff0266;
			}
      app-header {
				background-color: var(--primary-color);
				color: var(--secondary-text-color);
				--app-header-shadow: {
					box-shadow: inset 0px 5px 6px -3px rgba(0, 0, 0, 0.2);
				};
      }
			[drawer-toggle] {
				margin-right: 8px;
			}
			app-toolbar paper-icon-button {
				margin: 0 4px;
			}
			.logo {
				overflow: hidden;
				text-overflow: ellipsis;
				font-family: 'Product Sans', 'Roboto', 'Noto', sans-serif;
				font-weight: 600;
				color: #000;
			}
			[main-title] {
				font-size: 56px;
				margin-left: 46px;
			}
			[condensed-title] {
				font-size: 22px;
			}
			app-toolbar.bottom {
				height: auto;
				padding-bottom: 32px;
			}
      paper-tabs {
        height: 100%;
				--paper-tab-content-unselected: {
					opacity: 1;
				}
      }
      paper-tab {
				font-family: 'Product Sans', 'Roboto', 'Noto', sans-serif;
				text-transform: capitalize;
				padding: 0;
      }
			paper-tab a {
				@apply --layout-vertical;
				@apply --layout-center-center;
				padding: 0 16px;
				font-weight: 500;
  		}
      .pages {
        @apply --layout-flex;
      }
			neon-animated-pages > .iron-selected {
        @apply --layout-flex;
				position: relative;
			}
			paper-toast {
				@apply --layout-horizontal;
				@apply --layout-center;
				@apply --layout-justified;
			}
			#sharehome {
				@apply --shadow-elevation-12dp;
				max-width: 320px;
				background-color: #fff !important;
				color: var(--paper-grey-500);
			}
			.toast-button {
				text-transform: none;
				margin: 8px;
			}
			footer {
				@apply --layout-horizontal;
				@apply --layout-center;
    		@apply --layout-justified;
				background-color: var(--paper-grey-200);
				color: var(--secondary-text-color);
				font-size: 16px;
				padding: 32px;
			}
			footer paper-icon-button {
				margin: 4px;
			}
			#fab {
				@apply --shadow-elevation-4dp;
				--paper-fab-background: inherit;
				--paper-fab-keyboard-focus-background: inherit;
				color: #fff;
				position: fixed;
				z-index: 6;
				right: 20px;
				bottom: 20px;          
			}
			@media (max-width: 640px) {
				app-drawer {
					--app-drawer-width: 80%;
				}
				paper-toast {
					margin: 0;
					max-width: none;
					width: 100%;
				}
				#sharehome {
					max-width: none;
				}
				.toast-button {
					margin: 16px 8px;
				}
			}
    </style>
    <app-location
        route="{{route}}"
        url-space-regex="^[[rootPath]]">
    </app-location>
    <app-route
        route="{{route}}"
        pattern="[[rootPath]]:page"
        data="{{routeData}}"
        tail="{{subroute}}">
    </app-route>
		<iron-media-query query="min-width: 641px" query-matches="{{wideLayout}}"></iron-media-query>
		<paper-toast id="updateToast" duration="3000" text="App cached. Browse offline!">
			<paper-button onclick="window.location.reload(true)">Okay</paper-button>
		</paper-toast>
		<paper-toast id="ready_toast" duration="5000" text="Page cached. Browse offline."></paper-toast>
		<paper-toast id="sharehome" duration="0">
			<div class="flex-vertical">
				<div class="flex-horizontal">
					<div class="flexchild">Share via</div><paper-icon-button icon="my-icons:close" on-tap="openShare"></paper-icon-button>
				</div>
				<div on-tap="openShare">
					<template is="dom-repeat" items="[[social]]">
						<a href="{{item.link}}" target="_blank"><paper-icon-button class="toast-button" src="../images/assets/social/{{item.icon}}.svg"></paper-icon-button></a>
					</template>
					<a href="mailto:liyascthomas@gmail.com?&subject=Hello%20Liyas!&body=Hi," target="_blank">
						<paper-icon-button class="toast-button" icon="my-icons:mail"></paper-icon-button>
					</a>
					<a href="tel:+919539653962">
						<paper-icon-button class="toast-button" icon="my-icons:phone"></paper-icon-button>
					</a>
					<a href="about">
						<paper-icon-button class="toast-button" icon="my-icons:more-horiz"></paper-icon-button>
					</a>
				</div>
			</div>
		</paper-toast>
		<app-drawer-layout fullbleed force-narrow>
			<!-- Drawer content -->
			<app-drawer id="drawer" slot="drawer" swipe-open>
				<div class="drawer-contents">
					<app-toolbar class="drawer">
						<div class="logo">üë¶üíª</div>
					</app-toolbar>
					<paper-listbox selected="[[page]]" attr-for-selected="id" class="listbox" role="listbox" on-click="scrollTop">
						<a id="home" href="[[rootPath]]" tabindex="-1">
							<paper-icon-item>
								<iron-icon icon="my-icons:home" item-icon slot="item-icon"></iron-icon>
								<span>Home</span>
								<paper-ripple></paper-ripple>
							</paper-icon-item>
						</a>
						<a id="projects" tabindex="-1">
							<paper-icon-item on-click="toggle" aria-expanded$="[[opened]]" aria-controls="collapse">
								<iron-icon icon="my-icons:favorite" item-icon slot="item-icon"></iron-icon>
								<span class="expand">Projects</span>
								<iron-icon icon="my-icons:[[_getIcon(opened)]]"></iron-icon>
								<paper-ripple></paper-ripple>
							</paper-icon-item>
						</a>
						<iron-collapse id="collapse" opened="{{opened}}" tabindex="-1">
							<iron-ajax auto id="ajax" url="data/projects.json" loading="{{loading}}" handle-as="json" progress="{{progress}}" last-response="{{ajaxResponse}}" last-error="{{error}}" debounce-duration="300"></iron-ajax>
							<template is="dom-if" if="{{loading}}">
								<div class="actions flex-center-center" hidden$="[[!loading]]">
									<paper-spinner-lite active$="[[loading]]"></paper-spinner-lite>
								</div>
							</template>
							<template is="dom-if" if="{{error}}">
								<div class="error">
									<div>Failed to load projects list. Make sure you're connected to internet.</div>
									<span>üôÅüò¢üòí</span>
									<a href="javascript:location.reload();"><paper-icon-button icon="my-icons:refresh"></paper-icon-button></a>
								</div>
							</template>
							<template is="dom-repeat" items="[[ajaxResponse.android]]" as="android">
								<a href="android" tabindex="-1">
									<paper-icon-item class="category">
										<iron-icon icon="my-icons:[[android.icon]]" item-icon slot="item-icon"></iron-icon>
										<span class="expand">{{android.title}}</span>
										<iron-icon icon="my-icons:chevron-right"></iron-icon>
										<paper-ripple></paper-ripple>
									</paper-icon-item>
								</a>
								<template is="dom-repeat" items="[[android.sub]]" as="sub">
									<a href="[[sub.link]]" tabindex="-1">
										<paper-icon-item>
											<iron-icon icon="my-icons:[[sub.icon]]" item-icon slot="item-icon"></iron-icon>
											<span>{{sub.title}}</span>
											<paper-ripple></paper-ripple>
										</paper-icon-item>
									</a>
								</template>
							</template>
							<template is="dom-repeat" items="[[ajaxResponse.web]]" as="web">
								<a href="web" tabindex="-1">
									<paper-icon-item class="category">
										<iron-icon icon="my-icons:[[web.icon]]" item-icon slot="item-icon"></iron-icon>
										<span class="expand">{{web.title}}</span>
										<iron-icon icon="my-icons:chevron-right"></iron-icon>
										<paper-ripple></paper-ripple>
									</paper-icon-item>
								</a>
								<template is="dom-repeat" items="[[web.sub]]" as="sub">
									<a href="[[sub.link]]" tabindex="-1">
										<paper-icon-item>
											<iron-icon icon="my-icons:[[sub.icon]]" item-icon slot="item-icon"></iron-icon>
											<span>{{sub.title}}</span>
											<paper-ripple></paper-ripple>
										</paper-icon-item>
									</a>
								</template>
							</template>
							<template is="dom-repeat" items="[[ajaxResponse.other]]" as="other">
								<a href="other" tabindex="-1">
									<paper-icon-item class="category">
										<iron-icon icon="my-icons:[[other.icon]]" item-icon slot="item-icon"></iron-icon>
										<span class="expand">{{other.title}}</span>
										<iron-icon icon="my-icons:chevron-right"></iron-icon>
									</paper-icon-item>
								</a>
								<template is="dom-repeat" items="[[other.sub]]" as="sub">
									<a href="[[sub.link]]" tabindex="-1">
										<paper-icon-item>
											<iron-icon icon="my-icons:[[sub.icon]]" item-icon slot="item-icon"></iron-icon>
											<span>{{sub.title}}</span>
											<paper-ripple></paper-ripple>
										</paper-icon-item>
									</a>
								</template>
							</template>
							<a href="projects" tabindex="-1">
								<paper-icon-item class="category">
									<iron-icon icon="my-icons:work" item-icon slot="item-icon"></iron-icon>
										<span class="expand">View all projects</span>
										<iron-icon icon="my-icons:chevron-right"></iron-icon>
									<paper-ripple></paper-ripple>
								</paper-icon-item>
							</a>
						</iron-collapse>
						<a id="about" href="about" tabindex="-1">
							<paper-icon-item>
								<iron-icon icon="my-icons:face" item-icon slot="item-icon"></iron-icon>
								<span>About</span>
								<paper-ripple></paper-ripple>
							</paper-icon-item>
						</a>
					</paper-listbox>
				</div>
			</app-drawer>
      <!-- Main content -->
			<app-header-layout fullbleed>
				<app-header id="header" class="ptheme" slot="header" fixed condenses effects="waterfall resize-title">
					<app-toolbar sticky class="tab-nav">
						<paper-icon-button icon="my-icons:sort" drawer-toggle></paper-icon-button>
						<span condensed-title><div class="logo">üë¶üíª</div></span>
						<paper-tabs selected="[[page]]" attr-for-selected="id" autoselect no-bar on-click="scrollTop" hidden$="{{!wideLayout}}">
							<paper-tab id="home">
								<a href="[[rootPath]]" tabindex="-1">
									<iron-icon icon="my-icons:home"></iron-icon>
								</a>
							</paper-tab>
							<paper-tab id="projects">
								<a href="projects" tabindex="-1">
									<iron-icon icon="my-icons:favorite"></iron-icon>
								</a>
							</paper-tab>
							<paper-tab id="about">
								<a href="about" tabindex="-1">
									<iron-icon icon="my-icons:face"></iron-icon>
								</a>
							</paper-tab>
						</paper-tabs>
						<a href="mailto:liyascthomas@gmail.com?&subject=Hello Liyas!&body=Hi," taget="_blank">
							<paper-icon-button icon="my-icons:mail"></paper-icon-button>
						</a>
						<paper-icon-button icon="my-icons:share" on-tap="openShare"></paper-icon-button>
						<template is="dom-if" if="{{loading}}">
							<paper-progress value="{{progress}}" indeterminate active$="[[loading]]" top-item></paper-progress>
						</template>
					</app-toolbar>
					<app-toolbar class="bottom">
						<span main-title><div class="logo">üë¶üíª</div></span>
					</app-toolbar>
				</app-header>
				<div id="pages" class="pages">
					<neon-animated-pages selected="[[page]]" attr-for-selected="name" fallback-selection="404" role="main" entry-animation="fade-in-animation" exit-animation="fade-out-animation">
						<my-home name="home"></my-home>
						<my-projects name="projects"></my-projects>
						<my-about name="about"></my-about>
						<my-android name="android"></my-android>
						<my-web name="web"></my-web>
						<my-other name="other"></my-other>
						<my-saap name="saap"></my-saap>
						<my-404 name="404"></my-404>
					</neon-animated-pages>
				</div>
				<footer>
					<div>
						<a href="https://www.facebook.com/liyasthomas" target="_blank">
							<paper-icon-button src="../images/assets/social/facebook.svg"></paper-icon-button>
						</a>
						<a href="https://twitter.com/liyasthomas" target="_blank">
							<paper-icon-button src="../images/assets/social/twitter.svg"></paper-icon-button>
						</a>
						<a href="https://plus.google.com/+liyasthomas" target="_blank">
							<paper-icon-button src="../images/assets/social/google-plus.svg"></paper-icon-button>
						</a>
						<a href="https://github.com/liyasthomas" target="_blank">
							<paper-icon-button src="../images/assets/social/github.svg"></paper-icon-button>
						</a>
					</div>
				</footer>
				<a href="mailto:liyascthomas@gmail.com?&subject=Hello%20Liyas!&body=Hi," taget="_blank"><paper-fab id="fab" class="stheme" icon="my-icons:mail"></paper-fab></a>
			</app-header-layout>
		</app-drawer-layout>
	</template>
	<script>
		// Gesture events like tap and track generated from touch will not be
		// preventable, allowing for better scrolling performance.
		Polymer.setPassiveTouchGestures(true);
		class MyApp extends Polymer.Element {
			static get is() {
				return 'my-app';
			}
			static get properties() {
				return {
					page: {
						type: String,
						reflectToAttribute: true,
						observer: '_pageChanged'
					},
					wideLayout: {
						type: Boolean,
						value: false,
						reflectToAttribute: true,
						observer: 'onLayoutChange'
					},
					opened: {
						type: Boolean,
						reflectToAttribute: true
					},
					social: {
						type: Array,
						value: function() {
							return [{
									link: "https://www.facebook.com/liyasthomas",
									icon: "facebook"
								},
								{
									link: "https://twitter.com/liyasthomas",
									icon: "twitter"
								},
								{
									link: "https://plus.google.com/liyasthomas",
									icon: "google-plus"
								},
								{
									link: "https://github.com/liyasthomas",
									icon: "github"
								},
								{
									link: "https://www.linkedin.com/in/liyasthomas",
									icon: "linkedin"
								},
								{
									link: "https://www.linkedin.com/in/liyasthomas",
									icon: "behance"
								},
								{
									link: "https://www.linkedin.com/in/liyasthomas",
									icon: "dribbble"
								},
								{
									link: "https://api.whatsapp.com/send?phone=919539653962&text=Hi%20Liyas,",
									icon: "whatsapp"
								}
							]
						}
					},
					routeData: Object,
					subroute: String,
					// This shouldn't be neccessary, but the Analyzer isn't picking up
					// Polymer.Element#rootPath
					rootPath: String,
				};
			}
			static get observers() {
				return [
					'_routePageChanged(routeData.page)',
				];
			}
			show() {
				const hanimation = this.$.header.animate([
					{transform:'translateY(-100%)', easing: 'ease'},
					{transform:'translateY(0)', easing: 'ease'},
				],
				{
					duration: 800,
				});
				hanimation.finished.then(() => {
					this.$.header.style.transform = 'translateY(0)';
				});
				const fanimation = this.$.fab.animate([
					{transform:'scale(0)', easing: 'ease'},
					{transform:'scale(1)', easing: 'ease'},
				],
				{
					duration: 800,
				});
				fanimation.finished.then(() => {
					this.$.fab.style.transform = 'scale(1)';
				});
			}
			scrollTop() {
				var scrollDuration = 200;
				var scrollStep = -window.scrollY / (scrollDuration / 15),
					scrollInterval = setInterval(function() {
						if (window.scrollY != 0) {
							window.scrollBy(0, scrollStep);
						} else clearInterval(scrollInterval);
					}, 15);
			}
			update(worker) {
				this.$.updateToast.show();
			}
			openShare() {
				this.$.sharehome.toggle();
			}
			toggle() {
				this.$.collapse.toggle();
			}
			_getIcon(opened) {
				return opened ? 'expand-less' : 'expand-more';
			}
			constructor() {
				super();
			}
			ready() {
				super.ready();
			}
			connectedCallback() {
				super.connectedCallback();
				Polymer.RenderStatus.beforeNextRender(this, function() {
					this.$.ready_toast.open();
				});
			}
			_routePageChanged(page) {
				// If no page was found in the route data, page will be an empty string.
				// Default to 'home' in that case.
				this.page = page || 'home';
				// Close a non-persistent drawer when the page & route are changed.
				if (!this.$.drawer.persistent) {
					this.$.drawer.close();
				}
			}
			_pageChanged(page) {
				// Load page import on demand. Show 404 page if fails
				var resolvedPageUrl = this.resolveUrl('my-' + page + '.html');
				Polymer.importHref(
					resolvedPageUrl,
					null,
					this._showPage404.bind(this),
					true);
			}
			onLayoutChange(wide) {
				var drawer = this.$.drawer;
				if (wide && drawer.opened) {
					drawer.opened = false;
				}
			}
			_showPage404() {
				this.page = '404';
			}
		}
		window.customElements.define(MyApp.is, MyApp);
	</script>
</dom-module>
